export_synthetic_config:
  name: Export Synthetic Sensor Config
  description: Export the current synthetic sensor configuration to a YAML file. You can specify either a directory (file will be named automatically) or a full file path.
  fields:
    directory:
      name: File Path
      description: Either a directory path (file will be named automatically) or a full file path ending in .yaml where the configuration will be saved.
      required: true
      example: "/config/span_panel_sensor_config.yaml"
      selector:
        text:

cleanup_energy_spikes:
  name: Cleanup Energy Spikes
  description: >
    Detect and fix negative energy spikes from a specific SPAN panel's energy sensors
    caused by firmware updates or resets. Uses the main meter to detect reset timestamps
    where the cumulative energy value decreased. Adjusts the statistics sum values to
    restore continuity, eliminating spikes from the Energy Dashboard without data loss.
    Only processes statistics within the specified time range.
  fields:
    config_entry_id:
      name: Panel Config Entry ID
      description: >
        The config entry ID of the SPAN panel to clean up.
      required: true
      selector:
        config_entry:
          integration: span_panel
    start_time:
      name: Start Time
      description: >
        Local start date and time for the time range to scan (down to seconds).
        Only statistics within this time range will be processed.
      required: true
      selector:
        datetime:
    end_time:
      name: End Time
      description: >
        Local end date and time for the time range to scan (down to seconds).
        Must be after start_time. Only statistics within this time range will be processed.
      required: true
      selector:
        datetime:
    dry_run:
      name: Dry Run
      description: >
        Preview spikes without fixing. Returns list of detected spikes and adjustments.
        Defaults to true for safety - set to false to actually apply the corrections.
      required: false
      default: true
      selector:
        boolean:

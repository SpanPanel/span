export_synthetic_config:
  name: Export Synthetic Sensor Config
  description: Export the current synthetic sensor configuration to a YAML file. You can specify either a directory (file will be named automatically) or a full file path.
  fields:
    directory:
      name: File Path
      description: Either a directory path (file will be named automatically) or a full file path ending in .yaml where the configuration will be saved.
      required: true
      example: "/config/span_panel_sensor_config.yaml"
      selector:
        text:

cleanup_energy_spikes:
  name: Cleanup Energy Spikes
  description: >
    Detect and remove negative energy spikes from a specific SPAN panel's energy sensors
    caused by firmware updates or resets. Uses the main meter to detect reset timestamps
    where the cumulative energy value decreased (which violates TOTAL_INCREASING behavior).
    All energy sensor entries for that panel at those timestamps will be deleted.
  fields:
    config_entry_id:
      name: Panel Config Entry ID
      description: >
        The config entry ID of the SPAN panel to clean up. Find this in Settings → Devices &
        Services → SPAN Panel → click the panel → look at the URL for the config entry ID.
      required: true
      selector:
        config_entry:
          integration: span_panel
    days_back:
      name: Days to Scan
      description: Number of days in the past to scan for spikes. Defaults to 1 (last 24 hours).
      required: false
      default: 1
      selector:
        number:
          min: 1
          max: 365
          mode: box
          unit_of_measurement: "days"
    dry_run:
      name: Dry Run
      description: >
        Preview spikes without deleting. Returns list of what would be deleted.
        Defaults to true for safety - set to false to actually delete the entries.
      required: false
      default: true
      selector:
        boolean:
